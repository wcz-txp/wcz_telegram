# Name: wcz_telegram v0.1 
# Type: Admin/AJAX plugin
# A simple plugin to post articles to Telegram
# Author: whocarez
# URL: https://github.com/wcz-txp/wcz_telegram
# Recommended load order: 5

# .....................................................................
# This is a plugin for Textpattern CMS - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# .....................................................................

YToxMTp7czo0OiJuYW1lIjtzOjEyOiJ3Y3pfdGVsZWdyYW0iO3M6NjoiYXV0aG9yIjtzOjg6
Indob2NhcmV6IjtzOjEwOiJhdXRob3JfdXJpIjtzOjM5OiJodHRwczovL2dpdGh1Yi5jb20v
d2N6LXR4cC93Y3pfdGVsZWdyYW0iO3M6NzoidmVyc2lvbiI7czozOiIwLjEiO3M6MTE6ImRl
c2NyaXB0aW9uIjtzOjQ0OiJBIHNpbXBsZSBwbHVnaW4gdG8gcG9zdCBhcnRpY2xlcyB0byBU
ZWxlZ3JhbSI7czo0OiJjb2RlIjtzOjM1NDk6ImlmICh0eHBpbnRlcmZhY2UgPT0gJ2FkbWlu
JykKewogICAgYWRkX3ByaXZzKCd3Y3pfdGVsZWdyYW1fcG9zdCcsICcxJyk7CgogICAgcmVn
aXN0ZXJfY2FsbGJhY2soJ3djel90ZWxlZ3JhbScsICdhcnRpY2xlJywgJ2VkaXQnKTsKCiAg
ICByZWdpc3Rlcl9jYWxsYmFjaygnd2N6X3RlbGVncmFtX3VpJywgJ2FydGljbGVfdWknLCAn
c3RhdHVzJyk7Cgp9CgovLyBSZWdpc3RlciB0YWdzLgpUeHA6OmdldCgnXFRleHRwYXR0ZXJu
XFRhZ1xSZWdpc3RyeScpCiAgICAtPnJlZ2lzdGVyKCd3Y3pfdGVsZWdyYW0nKTsKCgoKCmZ1
bmN0aW9uIHdjel90ZWxlZ3JhbV91aSgkZXZlbnQsICRzdGVwLCAkZGF0YSwgJHJzMSkgewoK
ICAgICR2YXIgPSBncHMoJ3djel90ZWxlZ3JhbV9fdGhpcycpOwogICAgJGNvbnRlbnQgID0g
dGFnKHllc25vUmFkaW8oJ3djel90ZWxlZ3JhbV9fdGhpcycsICcwJywgJycsICd3Y3pfdGVs
ZWdyYW1fX3RoaXMnKSwncCcpOwogICAgcmV0dXJuICRkYXRhLmZpZWxkc2V0KCRjb250ZW50
LCAnU2VuZCB0byBUZWxlZ3JhbScsICd3Y3pfdGVsZWdyYW0nKTsKCn0KCgoKCmZ1bmN0aW9u
IHdjel90ZWxlZ3JhbSgpIHsKCgogICAgJGFydGljbGVfaWQgPSBlbXB0eSgkR0xPQkFMU1sn
SUQnXSkgPyBncHMoJ0lEJykgOiAkR0xPQkFMU1snSUQnXTsKICAgICRTdGF0dXMgPSBlbXB0
eSgkR0xPQkFMU1snU3RhdHVzJ10pID8gZ3BzKCdTdGF0dXMnKSA6ICRHTE9CQUxTWydTdGF0
dXMnXTsKICAgICR3Y3pfdGVsZWdyYW1fX3RoaXMgPSBlbXB0eSgkR0xPQkFMU1snd2N6X3Rl
bGVncmFtX190aGlzJ10pID8gZ3BzKCd3Y3pfdGVsZWdyYW1fX3RoaXMnKSA6ICRHTE9CQUxT
Wyd3Y3pfdGVsZWdyYW1fX3RoaXMnXTsKCiAgICBpZiAoJFN0YXR1cyA9PSA0IGFuZCAkd2N6
X3RlbGVncmFtX190aGlzID09IDEpCiAgICB7CgoKCWlmICghZW1wdHkoJGFydGljbGVfaWQp
KSAKCXsKCgkgICAgaW5jbHVkZV9vbmNlIHR4cGF0aC4nL3B1Ymxpc2gvdGFnaGFuZGxlcnMu
cGhwJzsKCgkgICAgJGFydGljbGUgPSBzYWZlX3JvdygiSUQsIFBvc3RlZCwgTGFzdE1vZCwg
VGl0bGUsIEV4Y2VycHQsIEtleXdvcmRzLCBTdGF0dXMiLCAndGV4dHBhdHRlcm4nLCJJRD17
JGFydGljbGVfaWR9Iik7Cgl9CgoKCSRhcnRpY2xlX3VybCA9IHBlcm1saW5rdXJsKCRhcnRp
Y2xlKTsKCSR0aXRsZSA9ICRhcnRpY2xlWydUaXRsZSddOwoJJGV4Y2VycHQgPSAkYXJ0aWNs
ZVsnRXhjZXJwdCddOwoJJGtleXdvcmRzID0gJGFydGljbGVbJ0tleXdvcmRzJ107CgovLyB0
aGUgdG9rZW4gb2YgeW91ciBUZWxlZ3JhbSBib3QKCSR3Y3pfdGVsZWdyYW1fdG9rZW4gPSAn
JzsKCi8vIHRoZSBjaGF0aWQgb2YgeW91ciBUZWxlZ3JhbSBjaGFubmVsCgkkd2N6X3RlbGVn
cmFtX2NoYXRpZCA9ICcnOwoKLy8gSWYgeW91IGhhdmUgYWxyZWFkeSBhIFRlbGVncmFtIElu
c3RhbnQgVmlldyB0ZW1wbGF0ZSAoaHR0cHM6Ly9pbnN0YW50dmlldy50ZWxlZ3JhbS5vcmcv
I3B1Ymxpc2hpbmctdGVtcGxhdGVzKSwgYnV0IHRoaXMgaXMgbm90IHJlYWxseSBwdWJsaWMK
Ly8geW91IHNob3VsZCBjb25zaWRlciB0byB1c2UgdGhpcyBvcHRpb24uIFNldCBpdCB0byAn
MScgYW5kIGNvcHkgdGhlIHJoYXNoLCBzbyBUZWxlZ3JhbSB1c2VycyB3aWxsIHNlZSB5b3Vy
IGFydGljbGUgb24gdGhlaXIgbW9iaWxlcwovLyBpbnNpZGUgVGVsZWdyYW0gcmVuZGVyZWQg
d2l0aCB5b3VyIHRlbXBsYXRlLgoJJHdjel90ZWxlZ3JhbV9pdiA9ICcwJzsKCSR3Y3pfdGVs
ZWdyYW1fcmhhc2ggPSAnJzsKCi8vIElmIHNvbWV0aGluZyBkb2Vzbid0IHdvcmssIHN3aXRj
aCBpdCB0byAnMScgYW5kIHlvdSdsbCBnZXQgdGhlIGNvbXBsZXRlIHJlcXVlc3QgaW5zaWRl
IG9mIHRleHRwYXR0ZXJuL3RtcC90ZWxlZ3JhbV9yZXF1ZXN0LnR4dAoJJHdjel90ZWxlZ3Jh
bV9kZWJ1ZyA9ICcwJzsKCglpZiAoJHdjel90ZWxlZ3JhbV9pdiA9PSAnMScpIAoJewoJICAg
ICRhcnRpY2xlX3VybCA9ICJodHRwczovL3QubWUvaXY/dXJsPSIuJGFydGljbGVfdXJsLiIm
cmhhc2g9Ii4kd2N6X3RlbGVncmFtX3JoYXNoOwoJfQoKCi8vICBlc2NhcGUgTWFya2Rvd24g
Zm9ybWF0dGluZyBjaGFyYWN0ZXIgIl8iCgkkYXJ0aWNsZV91cmwgPSBzdHJfcmVwbGFjZSgi
XyIsIlxfIiwkYXJ0aWNsZV91cmwpOwoKLy8gIHByZXBhcmUga2V5d29yZHMKCSRrZXl3b3Jk
cyA9IGV4cGxvZGUoIiwiLCRrZXl3b3Jkcyk7Cglmb3JlYWNoICgka2V5d29yZHMgYXMgJiRr
ZXl3b3JkKSAKCXsKCSAgICAka2V5d29yZCA9IHByZWdfcmVwbGFjZSgnL1xzKy8nLCAnJyxt
Yl9jb252ZXJ0X2Nhc2UoJGtleXdvcmQsIE1CX0NBU0VfVElUTEUpKTsKCX0KCgkka2V5d29y
ZHMgPSBpbXBsb2RlKCIgIixwcmVnX2ZpbHRlcignL14vJywgJyMnLCAka2V5d29yZHMpKTsK
Ci8vIDQwOTYgY2hhcmFjdGVycyBpcyB0aGUgbWF4aW11bSBwb3N0IGxlbmd0aAoKCSRleGNl
cnB0bGVuID0gNDA4MCAtIHN0cmxlbigkdGl0bGUpIC0gc3RybGVuKCRrZXl3b3JkcykgLSBz
dHJsZW4oJGFydGljbGVfdXJsKTsKCglpZiAoc3RybGVuKCRleGNlcnB0KSA+ICRleGNlcnB0
bGVuKSAKCXsKCSAgICAkcG9zPXN0cnBvcygkZXhjZXJwdCwgJyAnLCAkZXhjZXJwdGxlbik7
CgkgICAgJGV4Y2VycHQgPSAnIicuc3Vic3RyKCRleGNlcnB0LDAsJHBvcykuJyIgLi4uJzsK
CX0KCgkkbWVzc2FnZSA9ICIqIi4kdGl0bGUuIipcblxuIi4kZXhjZXJwdC4iXG5cbiIuJGtl
eXdvcmRzLiJcblxuIi4kYXJ0aWNsZV91cmw7CgoJJHVybCA9ICdodHRwczovL2FwaS50ZWxl
Z3JhbS5vcmcvYm90Jy4kd2N6X3RlbGVncmFtX3Rva2VuLicvc2VuZE1lc3NhZ2U/Y2hhdF9p
ZD0nLiR3Y3pfdGVsZWdyYW1fY2hhdGlkLicmcGFyc2VfbW9kZT1NYXJrZG93biZ0ZXh0PSc7
CgkkdXJsIC49IHVybGVuY29kZSgkbWVzc2FnZSk7CgoKLy8gc29tZSBkZWJ1ZyBzdHVmZgoJ
aWYgKCR3Y3pfdGVsZWdyYW1fZGVidWcgPT0gIjEiKSAKCXsKCSAgICBmaWxlX3B1dF9jb250
ZW50cyh0eHBhdGguIi90bXAvdGVsZWdyYW1fcmVxdWVzdC50eHQiLCJTZW50IFVSTDogXG4i
LiR1cmwuIlxuXG5QcmVwYXJlZCBtZXNzYWdlOlxuIi4kbWVzc2FnZS4iXG5cbkV4Y2VycHQg
bGVuZ3RoOlxuIi4kZXhjZXJwdGxlbi4iXG5cbkN1cmwgb3V0cHV0OlxuIik7Cgl9CgoKCSRj
aCA9IGN1cmxfaW5pdCgpOwoJY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgJHVybCk7
CgljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOwovLyBz
b21lIGRlYnVnIHN0dWZmCglpZiAoJHdjel90ZWxlZ3JhbV9kZWJ1ZyA9PSAiMSIpIAoJewoJ
ICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9WRVJCT1NFLCB0cnVlKTsKCSAgICAkY3Vy
bF92ZXJib3NlID0gZm9wZW4odHhwYXRoLicvdG1wL3RlbGVncmFtX3JlcXVlc3QudHh0Jywg
J2ErJyk7CgkgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NUREVSUiwgJGN1cmxfdmVy
Ym9zZSk7Cgl9CgoJJHJlc3BvbnNlID0gY3VybF9leGVjKCRjaCk7CgljdXJsX2Nsb3NlKCRj
aCk7CgogICAgfQp9CiI7czo0OiJ0eXBlIjtzOjE6IjQiO3M6NToib3JkZXIiO3M6MToiNSI7
czo1OiJmbGFncyI7czoxOiIwIjtzOjQ6ImhlbHAiO3M6NzQ4OiJBIHJlYWxseSByYXcgcGx1
Z2luIGZvciBhdXRvbWF0aWMgcG9zdGluZyBuZXcgYXJ0aWNsZXMgdG8gdGVsZWdyYW0uIEFs
bCB0aGUgcGFyYW1ldGVycyBhcmUgeWV0IGluc2lkZSB0aGUgY29kZS4KCiogKndjel90ZWxl
Z3JhbV90b2tlbio6IHRoZSB0b2tlbiBvZiB5b3VyIFRlbGVncmFtIGJvdAoqICp3Y3pfdGVs
ZWdyYW1fY2hhdGlkKjogdGhlIGNoYXRpZCBvZiB5b3VyIFRlbGVncmFtIGNoYW5uZWwKKiAq
d2N6X3RlbGVncmFtX2l2KiBhbmQgKndjel90ZWxlZ3JhbV9yaGFzaCo6IElmIHlvdSBoYXZl
IGFscmVhZHkgYSAiKlRlbGVncmFtIEluc3RhbnQgVmlldyB0ZW1wbGF0ZSoiOmh0dHBzOi8v
aW5zdGFudHZpZXcudGVsZWdyYW0ub3JnLyNwdWJsaXNoaW5nLXRlbXBsYXRlcywgYnV0IHRo
aXMgaXMgbm90IHJlYWxseSBwdWJsaWMgeW91IHNob3VsZCBjb25zaWRlciB0byB1c2UgdGhp
cyBvcHRpb24uIFNldCBpdCB0byAnMScgYW5kIGNvcHkgdGhlIHJoYXNoLCBzbyBUZWxlZ3Jh
bSB1c2VycyB3aWxsIHNlZSB5b3VyIGFydGljbGUgb24gdGhlaXIgbW9iaWxlcyBpbnNpZGUg
VGVsZWdyYW0gcmVuZGVyZWQgd2l0aCB5b3VyIHRlbXBsYXRlLgoqICp3Y3pfdGVsZWdyYW1f
ZGVidWcqOiBJZiBzb21ldGhpbmcgZG9lc24ndCB3b3JrLCBzd2l0Y2ggaXQgdG8gJzEnIGFu
ZCB5b3UnbGwgZ2V0IHRoZSBjb21wbGV0ZSByZXF1ZXN0IGluc2lkZSBvZiBiYy4gdGV4dHBh
dHRlcm4vdG1wL3RlbGVncmFtX3JlcXVlc3QudHh0IjtzOjM6Im1kNSI7czozMjoiOGVhNjAy
NDllNzk3NGUzZjMxNTc5MTE3OGQ4MDc5YWMiO30=
